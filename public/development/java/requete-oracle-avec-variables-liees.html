<!DOCTYPE html>
<html>
  <head>
    <title>
    Requête Oracle avec Variables Liées - wiki.ght1pc9kc.fr
</title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.40.2" />
<title>Requête Oracle avec Variables Liées :: wiki.ght1pc9kc.fr</title>
<link rel="shortcut icon" href="/images/logo.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/css/style.css" rel="stylesheet">
<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "";
</script>
  </head>
  <body data-url="/development/java/requete-oracle-avec-variables-liees.html">

    <header>
  
  <div class="logo">
	<a class="baselink" href="">
	    <img src="/images/logo.png" alt="wiki.ght1pc9kc.fr"/> wiki.ght1pc9kc.fr
	</a>
</div>
<span class="spacer">&nbsp;</span>
<div class="navbar-right">
    <form class="navbar-form navbar-left" action="/search.html" method="get">
       <input id="search-box" name="query" placeholder="Search..." autocomplete="off" spellcheck="false" dir="auto" type="text">
    </form>
</div>
</header>
<article>
  <aside class="menu">
    <div class="list-group">
        <a href="/cuisine.html" class="list-group-item list-group-item-action active">Cuisine</a>
    </div>
    <div class="list-group">
        <a href="/misc.html" class="list-group-item list-group-item-action active">Divers</a>
    </div>
    <div class="list-group">
        <a href="/development.html" class="list-group-item list-group-item-action active">Développement</a>
        <a href="/development/dotnet.html" class="list-group-item list-group-item-action ">.Net</a>
        <a href="/development/gwt.html" class="list-group-item list-group-item-action ">GWT</a>
        <a href="/development/java.html" class="list-group-item list-group-item-action ">Java</a>
        <a href="/development/javascript.html" class="list-group-item list-group-item-action ">Javascript</a>
        <a href="/development/spring.html" class="list-group-item list-group-item-action ">Spring</a>
    </div>
    <div class="list-group">
        <a href="/linux.html" class="list-group-item list-group-item-action active">Linux</a>
        <a href="/linux/administration.html" class="list-group-item list-group-item-action ">Administration</a>
        <a href="/linux/divers.html" class="list-group-item list-group-item-action ">Divers</a>
        <a href="/linux/gnomeshell.html" class="list-group-item list-group-item-action ">GnomeShell</a>
        <a href="/linux/network.html" class="list-group-item list-group-item-action ">Réseau</a>
        <a href="/linux/shell.html" class="list-group-item list-group-item-action ">Shell</a>
    </div>
    <div class="list-group">
        <a href="/outils.html" class="list-group-item list-group-item-action active">Outils</a>
        <a href="/outils/ansible.html" class="list-group-item list-group-item-action ">Ansible</a>
        <a href="/outils/docker.html" class="list-group-item list-group-item-action ">Docker</a>
        <a href="/outils/eclipse.html" class="list-group-item list-group-item-action ">Eclipse</a>
        <a href="/outils/git.html" class="list-group-item list-group-item-action ">Git</a>
        <a href="/outils/intellij.html" class="list-group-item list-group-item-action ">IntelliJ</a>
        <a href="/outils/latex.html" class="list-group-item list-group-item-action ">LaTeX</a>
        <a href="/outils/vmware.html" class="list-group-item list-group-item-action ">VMWare</a>
    </div>
    <div class="list-group">
        <a href="/serveurs.html" class="list-group-item list-group-item-action active">Serveur</a>
        <a href="/serveurs/http.html" class="list-group-item list-group-item-action ">HTTP</a>
        <a href="/serveurs/jboss.html" class="list-group-item list-group-item-action ">JBoss</a>
        <a href="/serveurs/mysql.html" class="list-group-item list-group-item-action ">MySQL</a>
        <a href="/serveurs/neo4j.html" class="list-group-item list-group-item-action ">Neo4J</a>
        <a href="/serveurs/oracle.html" class="list-group-item list-group-item-action ">Oracle</a>
        <a href="/serveurs/teradata.html" class="list-group-item list-group-item-action ">TeraData</a>
    </div>


  </aside>
  <section class="page">

    <h1>Requête Oracle avec Variables Liées</h1>
    
    

    

<p>C&rsquo;est un info qui date mais c&rsquo;est toujours juste.</p>

<h2 id="c-est-quoi-des-bind-variable-déjà">C&rsquo;est quoi des Bind Variable déjà ?</h2>

<p>Dans le processus d&rsquo;exécution d&rsquo;une requête, Oracle effectue plusieurs étapes. Parmi ces étapes, on retrouve le parsing.
Durant cette étape, oracle décortique l&rsquo;ordre SQL et choisit quel est le plan d&rsquo;exécution le plus court pour récupérer
les données ramenées par la requête.</p>

<p>Si une requête est exécuté 20 fois de suite, Oracle fait le parsing pour la première requête seulement.
Il se ressert des infos de parsing obtenu pour la première requête pour exécuter les autres.</p>

<p>La où les BV interviennent c&rsquo;est pour déterminer si une requête et une autre sont identique ou non et si du coup elle
partage ou non les même infos de parsing. Par exemple :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> colonne <span style="color:#66d9ef">from</span> table_toto <span style="color:#66d9ef">where</span> autre_colonne <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;valeur&#39;</span>;
<span style="color:#66d9ef">select</span> colonne <span style="color:#66d9ef">from</span> table_toto <span style="color:#66d9ef">where</span> autre_colonne <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;autre valeur&#39;</span>;</code></pre></div>
<p>Ces deux requête, si elles sont envoyées à Oracle de cette façon sont considérées comme des requêtes différente et le
parsing sera refait pour chaque requête alors qu&rsquo;au final, le plan d&rsquo;exécution est bien le même.</p>

<p>Si par contre, on avant la requête avec des BV au lieux des valeurs en dur :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> colonne <span style="color:#66d9ef">from</span> table_toto <span style="color:#66d9ef">where</span> autre_colonne <span style="color:#f92672">=</span> :b1;</code></pre></div>
<p>Là on peut exécuter la requête pour</p>

<ul>
<li>b1 = valeur</li>
<li>b1 = autre valeur
<br /></li>
</ul>

<p>Oracle considère les deux requêtes comme identique et ne refais pas l&rsquo;étape de parsing.</p>

<p>Le gain de temps représente l&rsquo;utilisation va de 5% à 25%. Le gain peut monter jusqu&rsquo;à 90% en utilisant le profilage de
requête qui est impossible sans les BV.</p>

<h2 id="concrètement-dans-le-code">Concrètement dans le code</h2>

<p>Concrètement dans le code Java, ça veut dire quoi ? Ca veut dire qu&rsquo;on évite les concaténations du genre :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">String requete <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;select colonne from table_toto where autre_colonne = &#39;&#34;</span><span style="color:#f92672">+</span>valeur<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&#39;&#34;</span></code></pre></div>
<p>On utilisera plutôt les <code>PreparedStatement</code> :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">String requete <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;select colonne from table_toto where autre_colonne = ?&#34;</span><span style="color:#f92672">;</span>
PreparedStatement statement <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">prepareStatement</span><span style="color:#f92672">(</span>requete<span style="color:#f92672">);</span>
statement<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;valeur&#34;</span><span style="color:#f92672">);</span>
ResultSet result <span style="color:#f92672">=</span> statement<span style="color:#f92672">.</span><span style="color:#a6e22e">executeQuery</span><span style="color:#f92672">();</span>
<span style="color:#75715e">// ...
</span><span style="color:#75715e"></span>statement<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;autre valeur&#34;</span><span style="color:#f92672">);</span>
ResultSet result <span style="color:#f92672">=</span> statement<span style="color:#f92672">.</span><span style="color:#a6e22e">executeQuery</span><span style="color:#f92672">();</span></code></pre></div>


    
    
  </section>

  
      <aside class="toc">
        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#c-est-quoi-des-bind-variable-déjà">C&rsquo;est quoi des Bind Variable déjà ?</a></li>
<li><a href="#concrètement-dans-le-code">Concrètement dans le code</a></li>
</ul></li>
</ul>
</nav>
      </aside>
  

</article>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>



<script src="/js/search.js"></script>


    
    

    
  </body>
</html>
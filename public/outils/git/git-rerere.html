<!DOCTYPE html>
<html>
  <head>
    <title>
    Git rerere - wiki.ght1pc9kc.fr
</title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.40.2" />
<title>Git rerere :: wiki.ght1pc9kc.fr</title>
<link rel="shortcut icon" href="/images/logo.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/css/style.css" rel="stylesheet">
<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "";
</script>
  </head>
  <body data-url="/outils/git/git-rerere.html">

    <header>
  
  <div class="logo">
	<a class="baselink" href="">
	    <img src="/images/logo.png" alt="wiki.ght1pc9kc.fr"/> wiki.ght1pc9kc.fr
	</a>
</div>
<span class="spacer">&nbsp;</span>
<div class="navbar-right">
    <form class="navbar-form navbar-left" action="/search.html" method="get">
       <input id="search-box" name="query" placeholder="Search..." autocomplete="off" spellcheck="false" dir="auto" type="text">
    </form>
</div>
</header>
<article>
  <aside class="menu">
    <div class="list-group">
        <a href="/cuisine.html" class="list-group-item list-group-item-action active">Cuisine</a>
    </div>
    <div class="list-group">
        <a href="/misc.html" class="list-group-item list-group-item-action active">Divers</a>
    </div>
    <div class="list-group">
        <a href="/development.html" class="list-group-item list-group-item-action active">Développement</a>
        <a href="/development/dotnet.html" class="list-group-item list-group-item-action ">.Net</a>
        <a href="/development/gwt.html" class="list-group-item list-group-item-action ">GWT</a>
        <a href="/development/java.html" class="list-group-item list-group-item-action ">Java</a>
        <a href="/development/javascript.html" class="list-group-item list-group-item-action ">Javascript</a>
        <a href="/development/spring.html" class="list-group-item list-group-item-action ">Spring</a>
    </div>
    <div class="list-group">
        <a href="/linux.html" class="list-group-item list-group-item-action active">Linux</a>
    </div>
    <div class="list-group">
        <a href="/outils.html" class="list-group-item list-group-item-action active">Outils</a>
        <a href="/outils/ansible.html" class="list-group-item list-group-item-action ">Ansible</a>
        <a href="/outils/docker.html" class="list-group-item list-group-item-action ">Docker</a>
        <a href="/outils/eclipse.html" class="list-group-item list-group-item-action ">Eclipse</a>
        <a href="/outils/git.html" class="list-group-item list-group-item-action ">Git</a>
        <a href="/outils/intellij.html" class="list-group-item list-group-item-action ">IntelliJ</a>
        <a href="/outils/latex.html" class="list-group-item list-group-item-action ">LaTeX</a>
        <a href="/outils/vmware.html" class="list-group-item list-group-item-action ">VMWare</a>
    </div>
    <div class="list-group">
        <a href="/serveurs.html" class="list-group-item list-group-item-action active">Serveur</a>
        <a href="/serveurs/http.html" class="list-group-item list-group-item-action ">HTTP</a>
        <a href="/serveurs/jboss.html" class="list-group-item list-group-item-action ">JBoss</a>
        <a href="/serveurs/mysql.html" class="list-group-item list-group-item-action ">MySQL</a>
        <a href="/serveurs/neo4j.html" class="list-group-item list-group-item-action ">Neo4J</a>
        <a href="/serveurs/oracle.html" class="list-group-item list-group-item-action ">Oracle</a>
        <a href="/serveurs/teradata.html" class="list-group-item list-group-item-action ">TeraData</a>
    </div>


  </aside>
  <section class="page">

    <h1>Git rerere</h1>
    
    

    

<p>Avec git, un des truc simpa c&rsquo;est le <code>rebase</code>, seulement voilà, avec des rebases
on se retrouve souvent avec des conflits et on en vient vite à passer plus de temps
à résoudre les conflits qu&rsquo;a coder.</p>

<p>Mais il se trouve que Git propose une commande au nom improblable pour préserver
notre fragile état mental, la commande <code>rerere</code>.</p>

<p>Pour activer rerere, la seule chose à faire est de l’indiquer en configuration :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git config --global rerere.enabled true</code></pre></div>
<p>Une fois activé, Git va se souvenir de la façon dont vous résolvez les conflits, sans votre intervention. Par exemple, avec un fichier nommé bonjour contenant sur master :</p>

<pre><code>hello ninjas
</code></pre>

<p>Une branche french est créée pour la version française :</p>

<pre><code>bonjour ninjas
</code></pre>

<p>Alors que sur master, une modification est appliquée</p>

<pre><code>hello ninjas!
</code></pre>

<p>Si la branche french est mergée, alors un conflit survient :</p>

<pre><code>Auto-merging bonjour
CONFLICT (content): Merge conflict in bonjour
Recorded preimage for 'bonjour'
Automatic merge failed; fix conflicts and then commit the result.
</code></pre>

<p>Si l’on édite le fichier, on a bien un conflit :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
hello ninjas!
=======
bonjour ninjas
&gt;&gt;&gt;&gt;&gt;&gt;&gt; french
</code></pre></div>
<p>Vous pouvez voir les fichiers en conflit surveillés par rerere :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ git rerere status
bonjour</code></pre></div>
<p>Vous corrigez le conflit, pour conserver :</p>

<pre><code>bonjour ninjas!
</code></pre>

<p>Vous pouvez voir ce que rerere retient de votre résolution avec :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ git rerere diff</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"><span style="color:#f92672">--- a/bonjour
</span><span style="color:#f92672"></span><span style="color:#a6e22e">+++ b/bonjour
</span><span style="color:#a6e22e"></span><span style="color:#75715e">@@ -1,5 +1 @@
</span><span style="color:#75715e"></span><span style="color:#f92672">-&lt;&lt;&lt;&lt;&lt;&lt;&lt;
</span><span style="color:#f92672">-bonjour ninjas
</span><span style="color:#f92672">-=======
</span><span style="color:#f92672">-hello ninjas!
</span><span style="color:#f92672">-&gt;&gt;&gt;&gt;&gt;&gt;&gt;
</span><span style="color:#f92672"></span><span style="color:#a6e22e">+bonjour ninjas!
</span><span style="color:#a6e22e"></span></code></pre></div>
<p>Une fois terminée la résolution du conflit (add et commit), vous pouvez voir la
présence d’un nouveau répertoire dans le dossier .git, nommé rr-cache, qui contient
maintenant un dossier correspondant à notre résolution dans lequel un fichier
conserve le conflit (preimage) et la résolution (postimage).</p>

<p>Maintenant, vous vous rendez compte que vous vous préféreriez un rebase plutôt
qu’un merge. Pas de problème, on reset le dernier merge :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ git reset --hard HEAD~1</code></pre></div>
<p>On se place sur la branche french et on rebase.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ git checkout french
$ git rebase master
...
Falling back to patching base and <span style="color:#ae81ff">3</span>-way merge...
Auto-merging bonjour
CONFLICT <span style="color:#f92672">(</span>content<span style="color:#f92672">)</span>: Merge conflict in bonjour
Resolved <span style="color:#e6db74">&#39;bonjour&#39;</span> using previous resolution.
Failed to merge in the changes.
Patch failed at <span style="color:#ae81ff">0001</span> bonjour ninjas!</code></pre></div>
<p>Nous avons le même conflit que précédemment, mais cette fois on peut voir
« Resolved bonjour using previous resolution. ». Et si nous ouvrons le fichier
bonjour, le conflit a été résolu automatiquement!</p>

<p>Par défaut, rerere n’ajoute pas le fichier à l’index, vous laissant le soin de
vérifier la résolution et de continuer le rebase. Il est possible avec l’option
‘rerere.autoupdate’ de faire cet ajout automatiquement à l’index (je préfère
  personnellement laisser cette option à ‘false’ et vérifier moi-même)!</p>

<p>A noter qu’il serait possible de remettre le fichier avec son conflit (si la
  résolution automatique ne vous convenait pas) :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ git checkout --conflict<span style="color:#f92672">=</span>merge bonjour</code></pre></div>
<p>Le fichier est alors à nouveau en conflit :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
hello ninjas!
=======
bonjour ninjas
&gt;&gt;&gt;&gt;&gt;&gt;&gt; french
</code></pre></div>
<p>Vous pouvez re-résoudre automatiquement le conflit avec :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ git rerere</code></pre></div>
<h2 id="liens">Liens</h2>

<ul>
<li><a href="https://hypedrivendev.wordpress.com/2013/08/30/git-rerere-ma-commande-preferee/">https://hypedrivendev.wordpress.com/2013/08/30/git-rerere-ma-commande-preferee/</a></li>
</ul>



    
    
  </section>

  
      <aside class="toc">
        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#liens">Liens</a></li>
</ul></li>
</ul>
</nav>
      </aside>
  

</article>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>



<script src="/js/search.js"></script>


    
    

    
  </body>
</html>
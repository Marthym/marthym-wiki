<!DOCTYPE html>
<html>
  <head>
    <title>
    Utiliser DataPump en ligne de commande - wiki.ght1pc9kc.fr
</title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.40.2" />
<title>Utiliser DataPump en ligne de commande :: wiki.ght1pc9kc.fr</title>
<link rel="shortcut icon" href="/images/logo.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/css/style.css" rel="stylesheet">
<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "";
</script>
  </head>
  <body data-url="/serveurs/oracle/utiliser-datapump-en-ligne-de-commande.html">

    <header>
  
  <div class="logo">
	<a class="baselink" href="">
	    <img src="/images/logo.png" alt="wiki.ght1pc9kc.fr"/> wiki.ght1pc9kc.fr
	</a>
</div>
<span class="spacer">&nbsp;</span>
<div class="navbar-right">
    <form class="navbar-form navbar-left" action="/search.html" method="get">
       <input id="search-box" name="query" placeholder="Search..." autocomplete="off" spellcheck="false" dir="auto" type="text">
    </form>
</div>
</header>
<article>
  <aside class="menu">
    <div class="list-group">
        <a href="/cuisine.html" class="list-group-item list-group-item-action active">Cuisine</a>
    </div>
    <div class="list-group">
        <a href="/misc.html" class="list-group-item list-group-item-action active">Divers</a>
    </div>
    <div class="list-group">
        <a href="/development.html" class="list-group-item list-group-item-action active">Développement</a>
        <a href="/development/dotnet.html" class="list-group-item list-group-item-action ">.Net</a>
        <a href="/development/gwt.html" class="list-group-item list-group-item-action ">GWT</a>
        <a href="/development/java.html" class="list-group-item list-group-item-action ">Java</a>
        <a href="/development/javascript.html" class="list-group-item list-group-item-action ">Javascript</a>
        <a href="/development/spring.html" class="list-group-item list-group-item-action ">Spring</a>
    </div>
    <div class="list-group">
        <a href="/linux.html" class="list-group-item list-group-item-action active">Linux</a>
        <a href="/linux/administration.html" class="list-group-item list-group-item-action ">Administration</a>
        <a href="/linux/divers.html" class="list-group-item list-group-item-action ">Divers</a>
        <a href="/linux/gnomeshell.html" class="list-group-item list-group-item-action ">GnomeShell</a>
        <a href="/linux/network.html" class="list-group-item list-group-item-action ">Réseau</a>
        <a href="/linux/shell.html" class="list-group-item list-group-item-action ">Shell</a>
    </div>
    <div class="list-group">
        <a href="/outils.html" class="list-group-item list-group-item-action active">Outils</a>
        <a href="/outils/ansible.html" class="list-group-item list-group-item-action ">Ansible</a>
        <a href="/outils/docker.html" class="list-group-item list-group-item-action ">Docker</a>
        <a href="/outils/eclipse.html" class="list-group-item list-group-item-action ">Eclipse</a>
        <a href="/outils/git.html" class="list-group-item list-group-item-action ">Git</a>
        <a href="/outils/intellij.html" class="list-group-item list-group-item-action ">IntelliJ</a>
        <a href="/outils/latex.html" class="list-group-item list-group-item-action ">LaTeX</a>
        <a href="/outils/vmware.html" class="list-group-item list-group-item-action ">VMWare</a>
    </div>
    <div class="list-group">
        <a href="/serveurs.html" class="list-group-item list-group-item-action active">Serveur</a>
        <a href="/serveurs/http.html" class="list-group-item list-group-item-action ">HTTP</a>
        <a href="/serveurs/jboss.html" class="list-group-item list-group-item-action ">JBoss</a>
        <a href="/serveurs/mysql.html" class="list-group-item list-group-item-action ">MySQL</a>
        <a href="/serveurs/neo4j.html" class="list-group-item list-group-item-action ">Neo4J</a>
        <a href="/serveurs/oracle.html" class="list-group-item list-group-item-action ">Oracle</a>
        <a href="/serveurs/teradata.html" class="list-group-item list-group-item-action ">TeraData</a>
    </div>


  </aside>
  <section class="page">

    <h1>Utiliser DataPump en ligne de commande</h1>
    
    

    

<p>Depuis la 10g, il y a deux méthodes pour exporter/importer un schéma :</p>

<ul>
<li>Import / Export normaux (exp)</li>
<li>DataPump (&gt;=10g uniquement) (expdp)
La méthode ~DataPump est plus rapide et plus souple. Préférez donc celle là !</li>
</ul>

<h2 id="datapump">DataPump</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">c:<span style="color:#ae81ff">\&gt;</span> expdp system/manager directory<span style="color:#f92672">=</span>DATA_PUMP_DIR dumpfile<span style="color:#f92672">=</span>EDGE_SP3_FIX016_AXA.dmp schemas<span style="color:#f92672">=</span>edge</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">c:<span style="color:#ae81ff">\&gt;</span> impdp system/manager directory<span style="color:#f92672">=</span>DATA_PUMP_DIR dumpfile<span style="color:#f92672">=</span>EDGE_SP3_FIX016_AXA.dmp schemas<span style="color:#f92672">=</span>edge</code></pre></div>
<p>L&rsquo;intérêt du ~DataPump est qu&rsquo;il crée les schémas s&rsquo;ils n&rsquo;existent pas, qu&rsquo;il permet de re-mapper les schémas et les
tablespaces très facilement et qu&rsquo;il va 3x plus vite que l&rsquo;export normal.</p>

<h3 id="localiser-le-directory">Localiser le DIRECTORY</h3>

<p>L&rsquo;une des particularité du Datapump est qu&rsquo;à l&rsquo;inverse de l&rsquo;export standard, les fichiers sont lut et écrit, non pas
dans le répertoire courant mais dans un DIRECTORY Oracle, genre de lien base de données vers un répertoire physique.
Il ne faut donc pas mettre le fichier n&rsquo;importe où !</p>

<p>Par défaut, un DIRECTORY est toujours présent dans Oracle, le directory ~DATA_PUMP_DIR. Il se trouve généralement dans
$ORACLE_HOME/admin/INSTANCE/dpdump. Mais cela diffère selon les installation. Pour le localiser à coup sur, sous
sql*plus :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SQL</span><span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> dba_directories;

<span style="color:#66d9ef">OWNER</span>   DIRECTORY_NAME   DIRECTORY_PATH  
<span style="color:#75715e">------- ---------------- -------------------------------------------- 
</span><span style="color:#75715e"></span>SYS     DATA_PUMP_DIR    D:<span style="color:#960050;background-color:#1e0010">\</span>oracle<span style="color:#960050;background-color:#1e0010">\</span>product<span style="color:#960050;background-color:#1e0010">\</span><span style="color:#ae81ff">10</span>.<span style="color:#ae81ff">2</span>.<span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#66d9ef">admin</span><span style="color:#960050;background-color:#1e0010">\</span>campj<span style="color:#960050;background-color:#1e0010">\</span>dpdump<span style="color:#960050;background-color:#1e0010">\</span>  </code></pre></div>
<p>Il est aussi possible d&rsquo;en créer un avec la commande :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SQL</span><span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">create</span> directory TEMP_DATAPUMP_DIR <span style="color:#66d9ef">as</span> <span style="color:#e6db74">&#39;c:\\temp\\&#39;</span>;</code></pre></div>
<p>Attention ! Oracle ne vérifie l&rsquo;existence ni les permissions du répertoire ! S&rsquo;il y a un soucis de ce genre c&rsquo;est au
moment du dump qu&rsquo;une erreur sera levé !</p>

<h3 id="remarque-1">Remarque 1</h3>

<p>le paramètre SQLFILE de la commande impdp permet d&rsquo;obtenir un fichier SQL contenant les requêtes de l&rsquo;import. Ca permet
entre autre d&rsquo;avoir la liste des tablespaces de l&rsquo;export.</p>

<h3 id="remarque-2">Remarque 2</h3>

<p>Il est possible de re-mapper les tablespaces ou les users pour, par exemple, déverser un user edge_test dans un user
edge_prod. Les paramètres ~REMAP_SCHEMA et ~REMAP_TABLESPACE s&rsquo;utilisent de la façon suivante :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">c:<span style="color:#ae81ff">\&gt;</span> impdp system/manager directory<span style="color:#f92672">=</span>DATA_PUMP_DIR dumpfile<span style="color:#f92672">=</span>EDGE_SP3_FIX016_AXA.dmp remap_schema<span style="color:#f92672">=</span>edge:cameleon remap_tablespace<span style="color:#f92672">=</span>users:tbs_cameleon</code></pre></div>
<h2 id="page-d-aide">Page d&rsquo;aide</h2>

<p>Pour obtenir la liste des options :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">expdp help<span style="color:#f92672">=</span>y</code></pre></div>
<pre><code>Copyright (c) 2003, 2005, Oracle.  All rights reserved.


The Data Pump export utility provides a mechanism for transferring data objects
between Oracle databases. The utility is invoked with the following command:

   Example: expdp scott/tiger DIRECTORY=dmpdir DUMPFILE=scott.dmp

You can control how Export runs by entering the 'expdp' command followed
by various parameters. To specify parameters, you use keywords:

   Format:  expdp KEYWORD=value or KEYWORD=(value1,value2,...,valueN)
   Example: expdp scott/tiger DUMPFILE=scott.dmp DIRECTORY=dmpdir SCHEMAS=scott
               or TABLES=(T1:P1,T1:P2), if T1 is partitioned table

USERID must be the first parameter on the command line.

Keyword               Description (Default)
------------------------------------------------------------------------------
ATTACH                Attach to existing job, e.g. ATTACH [=job name].
COMPRESSION           Reduce size of dumpfile contents where valid
                      keyword values are: (METADATA_ONLY) and NONE.
CONTENT               Specifies data to unload where the valid keywords are:
                      (ALL), DATA_ONLY, and METADATA_ONLY.
DIRECTORY             Directory object to be used for dumpfiles and logfiles.
DUMPFILE              List of destination dump files (expdat.dmp),
                      e.g. DUMPFILE=scott1.dmp, scott2.dmp, dmpdir:scott3.dmp.
ENCRYPTION_PASSWORD   Password key for creating encrypted column data.
ESTIMATE              Calculate job estimates where the valid keywords are:
                      (BLOCKS) and STATISTICS.
ESTIMATE_ONLY         Calculate job estimates without performing the export.
EXCLUDE               Exclude specific object types, e.g. EXCLUDE=TABLE:EMP.
FILESIZE              Specify the size of each dumpfile in units of bytes.
FLASHBACK_SCN         SCN used to set session snapshot back to.
FLASHBACK_TIME        Time used to get the SCN closest to the specified time.
FULL                  Export entire database (N).
HELP                  Display Help messages (N).
INCLUDE               Include specific object types, e.g. INCLUDE=TABLE_DATA.
JOB_NAME              Name of export job to create.
LOGFILE               Log file name (export.log).
NETWORK_LINK          Name of remote database link to the source system.
NOLOGFILE             Do not write logfile (N).
PARALLEL              Change the number of active workers for current job.
PARFILE               Specify parameter file.
QUERY                 Predicate clause used to export a subset of a table.
SAMPLE                Percentage of data to be exported;
SCHEMAS               List of schemas to export (login schema).
STATUS                Frequency (secs) job status is to be monitored where
                      the default (0) will show new status when available.
TABLES                Identifies a list of tables to export - one schema only.
TABLESPACES           Identifies a list of tablespaces to export.
TRANSPORT_FULL_CHECK  Verify storage segments of all tables (N).
TRANSPORT_TABLESPACES List of tablespaces from which metadata will be unloaded.
VERSION               Version of objects to export where valid keywords are:
                      (COMPATIBLE), LATEST, or any valid database version.

The following commands are valid while in interactive mode.
Note: abbreviations are allowed

Command               Description
------------------------------------------------------------------------------
ADD_FILE              Add dumpfile to dumpfile set.
CONTINUE_CLIENT       Return to logging mode. Job will be re-started if idle.
EXIT_CLIENT           Quit client session and leave job running.
FILESIZE              Default filesize (bytes) for subsequent ADD_FILE commands.
HELP                  Summarize interactive commands.
KILL_JOB              Detach and delete job.
PARALLEL              Change the number of active workers for current job.
                      PARALLEL=&lt;number of workers&gt;.
START_JOB             Start/resume current job.
STATUS                Frequency (secs) job status is to be monitored where
                      the default (0) will show new status when available.
                      STATUS[=interval]
STOP_JOB              Orderly shutdown of job execution and exits the client.
                      STOP_JOB=IMMEDIATE performs an immediate shutdown of the
                      Data Pump job.
</code></pre>



    
    
  </section>

  
      <aside class="toc">
        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#datapump">DataPump</a>
<ul>
<li><a href="#localiser-le-directory">Localiser le DIRECTORY</a></li>
<li><a href="#remarque-1">Remarque 1</a></li>
<li><a href="#remarque-2">Remarque 2</a></li>
</ul></li>
<li><a href="#page-d-aide">Page d&rsquo;aide</a></li>
</ul></li>
</ul>
</nav>
      </aside>
  

</article>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>



<script src="/js/search.js"></script>


    
    

    
  </body>
</html>